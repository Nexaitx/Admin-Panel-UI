<div class="container-fluid py-3">
  <h4 class="semibold mb-0">Welcome Back, {{userProfile?.fullName}}!</h4>
  <p class="text-muted">We're glad to see you again. Here's what's happening in your dashboard:</p>
  <div class="row p-2 mt-3">
    <div class="col-md-4">
      <mat-card class="example-card bg-white shadow" appearance="outlined">
        <mat-card-header>
          <mat-card-title class="d-flex"> <mat-icon> person_pin</mat-icon> {{role}}</mat-card-title>
        </mat-card-header>
        <hr class="my-0">
        <mat-card-content class="text-muted m-3">
          <small class="d-flex"><mat-icon> mail_outline</mat-icon>&nbsp;{{userProfile?.email}}</small>

          <small class="d-flex mt-2"><mat-icon> phone</mat-icon>&nbsp;{{userProfile?.phoneNumber}}</small>
        </mat-card-content>

      </mat-card>

      <mat-card class="example-card my-2 bg-white shadow" appearance="outlined">
        <mat-card-header class="d-flex justify-content-between">
          <mat-card-title>Staff Types</mat-card-title>
          <mat-icon class="navigations" [routerLink]="['/app/staff']" matTooltip="View Staff">launch</mat-icon>
        </mat-card-header>
        <hr class="mb-0">
        <mat-card-content>

          <div id="chart">
            <apx-chart [series]="chartOptionsStaffType.series" [chart]="chartOptionsStaffType.chart"
              [labels]="chartOptionsStaffType.labels" [fill]="chartOptionsStaffType.fill"
              [stroke]="chartOptionsStaffType.stroke" [responsive]="chartOptionsStaffType.responsive"></apx-chart>
          </div>
        </mat-card-content>

      </mat-card>

    </div>

    <div class="col-md-4 mb-2">
      <mat-card class="example-card bg-white shadow" appearance="outlined">
        <mat-card-header>
          <mat-card-title>Accounts</mat-card-title>
          <mat-card-subtitle>
            <small class="text-muted mb-0 mt-1">Role Wise Account Overview</small>
          </mat-card-subtitle>
        </mat-card-header>
        <hr class="mb-0">
        <mat-card-content class="example-card-footer">
          <div id="chart">
            <apx-chart [series]="chartOptions.series" [chart]="chartOptions.chart"
              [plotOptions]="chartOptions.plotOptions" [labels]="chartOptions.labels"></apx-chart>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <div class="col-md-4 mb-2">
      <mat-card class="example-card bg-white shadow" appearance="outlined">
        <mat-card-header class="d-flex justify-content-between">
          <mat-card-title>Clients & Staff Stats</mat-card-title>
          <mat-icon class="navigations" [routerLink]="['/app/client']" matTooltip="View Clients">launch</mat-icon>
        </mat-card-header>
        <hr class="mb-0 mt-1">
        <mat-card-content>
          <div id="chart">
            <apx-chart [series]="chartOptionClientStaff.series" [chart]="chartOptionClientStaff.chart"
              [dataLabels]="chartOptionClientStaff.dataLabels" [plotOptions]="chartOptionClientStaff.plotOptions"
              [yaxis]="chartOptionClientStaff.yaxis" [legend]="chartOptionClientStaff.legend"
              [fill]="chartOptionClientStaff.fill" [stroke]="chartOptionClientStaff.stroke"
              [tooltip]="chartOptionClientStaff.tooltip" [xaxis]="chartOptionClientStaff.xaxis"></apx-chart>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>

  <div class="row my-3">
    <div class="col-12">
      <mat-card class="example-card bg-white shadow" appearance="outlined">
        <div class="d-flex justify-content-center align-items-center my-3">
          <div>
            <mat-card-header>
              <mat-card-title>
                Bookings Overview
              </mat-card-title>
            </mat-card-header>
            <mat-card-content>
              <div id="chart">
                <apx-chart [series]="chartOptionsBooking.series" [chart]="chartOptionsBooking.chart"
                  [labels]="chartOptionsBooking.labels" [responsive]="chartOptionsBooking.responsive"></apx-chart>
              </div>
            </mat-card-content>
          </div>
        </div>
      </mat-card>
    </div>
  </div>

  <div class="row my-3">
    <div class="col-md-8">
      <mat-card class="example-card bg-white shadow" appearance="outlined">
        <mat-card-header class="d-flex justify-content-between">
          <mat-card-title class="d-flex">Recent Bookings</mat-card-title>
          <button matButton="tonal" (click)="toggleView()">
            {{ showAll ? 'Show Less' : 'View All' }}
          </button>
        </mat-card-header>
        <hr class="my-1">
        <mat-card-content class="text-muted m-3">
          <table mat-table [dataSource]="dataSource" class="bg-white">
            @for (column of columns; track column) {
            @if (column.columnDef !== 'status') {
            <ng-container [matColumnDef]="column.columnDef">
              <th mat-header-cell *matHeaderCellDef>
                {{column.header}}
              </th>
              <td mat-cell *matCellDef="let row">
                {{column.cell(row)}}
              </td>
            </ng-container>
            }
            }

            <ng-container matColumnDef="status">
              <th mat-header-cell *matHeaderCellDef>
                Status
              </th>
              <td mat-cell *matCellDef="let row">
                <small class="status" [ngStyle]="{
        'background-color': getStatusBackgroundColor(row.status),
        'color': getStatusColor(row.status),
      }">{{row.status}}</small>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
        </mat-card-content>

      </mat-card>
    </div>

    <div class="col-md-4">
      <mat-card class="example-card bg-white shadow" appearance="outlined">
        <mat-card-header class="d-flex justify-content-between">
          <mat-card-title class="d-flex">Recent Diet Plans</mat-card-title>
          <button mat-button (click)="toggleViewAll()">
            {{ showAllDietPlans ? 'Show Less' : 'View All' }}
          </button>
        </mat-card-header>
        <hr class="my-1">
        <mat-card-content class="text-muted m-3">
          <ul type="none" [ngClass]="{'scrollable': showAllDietPlans}" class="diet-plan-list ps-0 dietPlans">
            <li *ngFor="let plan of dietPlansToShow()" class="border-bottom py-2">
              {{ plan.planType }}
              <br>
              <small>{{plan?.title}}</small>
            </li>
          </ul>
        </mat-card-content>
      </mat-card>

    </div>
  </div>
</div>