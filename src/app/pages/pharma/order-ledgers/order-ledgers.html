<div class="container-fluid px-0">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="h4 mb-0">Order Ledger</h2>
        <button mat-flat-button color="primary">
            <mat-icon>save</mat-icon> Save Ledger
        </button>
    </div>

    <div class="table-container mat-elevation-z2">
        <table mat-table [dataSource]="dataSource" class="w-100">

            <ng-container matColumnDef="serialNo">
                <th mat-header-cell *matHeaderCellDef> S.No </th>
                <td mat-cell *matCellDef="let i = index"> {{i + 1}} </td>
            </ng-container>

            <ng-container matColumnDef="medicine">
                <th mat-header-cell *matHeaderCellDef> Medicine </th>
                <td mat-cell *matCellDef="let element"> {{element.name}} </td>
            </ng-container>

            <ng-container matColumnDef="quantity">
                <th mat-header-cell *matHeaderCellDef> Qty </th>
                <td mat-cell *matCellDef="let element">
                    <mat-form-field appearance="outline" class="compact-input">
                        <input matInput type="number" [(ngModel)]="element.qty" [max]="element.maxQty"
                            (change)="validateQty(element)">
                        <mat-hint>Max: {{element.maxQty}}</mat-hint>
                    </mat-form-field>
                </td>
            </ng-container>

            <ng-container matColumnDef="status">
                <th mat-header-cell *matHeaderCellDef> Availability </th>
                <td mat-cell *matCellDef="let element">
                    <mat-form-field appearance="outline" class="status-dropdown">
                        <mat-select [(ngModel)]="element.isAvailable"
                            [ngClass]="element.isAvailable ? 'text-success' : 'text-danger'">
                            <mat-option [value]="true">
                                <mat-icon class="status-icon success-icon">check_circle</mat-icon>
                                Available
                            </mat-option>
                            <mat-option [value]="false">
                                <mat-icon class="status-icon danger-icon">cancel</mat-icon>
                                Non Available
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </td>
            </ng-container>

            <ng-container matColumnDef="mrp">
                <th mat-header-cell *matHeaderCellDef> MRP </th>
                <td mat-cell *matCellDef="let element"> {{element.mrp | currency:'INR'}} </td>
            </ng-container>

            <ng-container matColumnDef="offerPrice">
                <th mat-header-cell *matHeaderCellDef> Offer Price </th>
                <td mat-cell *matCellDef="let element">
                    <mat-form-field appearance="outline" class="compact-input">
                        <input matInput type="number" [(ngModel)]="element.offerPrice"
                            (input)="calculatePayouts(element)">
                    </mat-form-field>
                </td>
            </ng-container>

            <ng-container matColumnDef="category">
                <th mat-header-cell *matHeaderCellDef> Category </th>
                <td mat-cell *matCellDef="let element">
                    <mat-form-field appearance="outline" class="compact-input">
                        <mat-select [(ngModel)]="element.category">
                            <mat-option value="OTC">OTC</mat-option>
                            <mat-option value="Ethical">Ethical</mat-option>
                            <mat-option value="Surgical">Surgical</mat-option>
                            <mat-option value="Generic">Generic</mat-option>
                        </mat-select>
                    </mat-form-field>
                </td>
            </ng-container>

            <ng-container matColumnDef="companyShare">
                <th mat-header-cell *matHeaderCellDef> Vitoxyz Share </th>
                <td mat-cell *matCellDef="let element"> {{element.companyShare | currency:'INR'}} </td>
            </ng-container>

            <ng-container matColumnDef="payout">
                <th mat-header-cell *matHeaderCellDef> Net Payout </th>
                <td mat-cell *matCellDef="let element">
                    <strong class="text-primary">{{element.payout | currency:'INR'}}</strong>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
    </div>
</div>